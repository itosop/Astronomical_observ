<!DOCTYPE html>
<html>
  <head>
    <title>星座早見盤の自動回転</title>
    <meta charset="utf-8" />
    <script language="javascript" type="text/javascript">
      function input_img(){
	var data = document.getElementById("in_img");
	data.onload = function() {
	}
	data.src = select_img();
        compass();
      }

      function compass(){
        if (navigator.geolocation){
          navigator.geolocation.getCurrentPosition(
            function(position){
              var hd = position.coords.heading || "方角には未対応です";
              var txt = "方角："+hd;
              document.getElementById("result").innerHTML = txt;
            }
          );
        }
        else{
          document.getElementById("result").innerHTML = "Geo Location APIに対応していません";
        }        
      }

      function image_rotate(x){
	var image = document.getElementById("img1");
	image.style.transform = "rotate("+ x + "deg)";
      }

      function select_img(){
	var hiduke = new Date();
	var month = hiduke.getMonth()+1;
	var day = hiduke.getDate();
	var hour = hiduke.getHours();
	var minute = hiduke.getMinutes();
	var minute_tmp = minute / 10;
	minute = minute_tmp * 10;

	if (month < 10) {
	  var tmpname = 'RotateImg/' + 'star' + 0 + month;
	  if (day < 10) {
	    tmpname = tmpname + '0' + day + '_';
	    if (hour < 10) {
	      tmpname = tmpname + 0 + hour;
	      if (minute == 0) {
		var filename = tmpname + '00' + '.png';
	      }
	      else {
		var filename = tmpname + minute + '.png';
	      }
	    }
	    else {
	      tmpname = tmpname + hour;
	      if (minute == 0) {
                var filename = tmpname + '00' + '.png';
              }
              else {
                var filename = tmpname + minute + '.png';
              }
	    }
	  }
	  else {
	    tmpname = tmpname + day + '_';
	    if (hour < 10) {
              tmpname = tmpname + 0 + hour;
              if (minute == 0) {
                var filename = tmpname + '00' + '.png';
              }
              else {
                var filename = tmpname + minute + '.png';
              }
            }
            else {
              tmpname = tmpname + hour;
              if (minute == 0) {
                var filename = tmpname + '00' + '.png';
              }
              else {
                var filename = tmpname + minute + '.png';
              }
            }
	  }
	}
	else {
	  if (day < 10) {
            tmpname = tmpname + '0' + day + '_';
            if (hour < 10) {
              tmpname = tmpname + 0 + hour;
              if (minute == 0) {
                var filename = tmpname + '00' + '.png';
              }
              else {
                var filename = tmpname + minute + '.png';
              }
            }
            else {
              tmpname = tmpname + hour;
              if (minute == 0) {
                var filename = tmpname + '00' + '.png';
              }
              else {
                var filename = tmpname + minute + '.png';
              }
            }
          }
          else {
            tmpname = tmpname + day + '_';
            if (hour < 10) {
              tmpname = tmpname + 0 + hour;
              if (minute == 0) {
                var filename = tmpname + '00' + '.png';
              }
              else {
                var filename = tmpname + minute + '.png';
              }
            }
            else {
              tmpname = tmpname + hour;
              if (minute == 0) {
                var filename = tmpname + '00' + '.png';
              }
	      else {
                var filename = tmpname + minute + '.png';
              }
            }
	  }
	}
	var filename1 = 'RotateImg/star0518_0000.png';
	return filename1;
      }
    </script>
  </head>

  <body>
    <!-- <style> -->
    <h1>星座の早見盤を自動で回転させます．</h1>
      <!-- <img src="star0518_0000.png" id="in_img"> -->
      <button type="button" class="btn" onclick="input_img()">button</button>
    <!-- </style> -->
    <link rel="stylesheet" href="style.css">
    <p>
	<!-- <canvas id="test_canvas" width=1000 height=1000 style="border: 1px solid;"></canvas> -->
	<img id="in_img">
    </p>
    <div id="result"></div>
    <a href="http://hoshifuru.jp/EveryStarryNight/planisphere/ai/">星座早見盤：Every Starry Night Planisphere ( hoshifuru.jp )</a>
  </body>
</html>
